Help on class TorchInferencer in module anomalib.deploy.inferencers.torch_inferencer:

class TorchInferencer(builtins.object)
 |  TorchInferencer(path: str | pathlib.Path, device: str = 'auto') -> None
 |  
 |  PyTorch inferencer for anomaly detection models.
 |  
 |  .. warning::
 |      This is a legacy inferencer. It is recommended to use :class:`anomalib.engine.Engine.predict()`
 |      instead, which provides a more modern and feature-rich interface for model inference.
 |  
 |  .. danger::
 |      **Security Notice**: PyTorch model loading uses Python's pickle module,
 |      which can execute code from the checkpoint file. This is a standard PyTorch behavior,
 |      not specific to this library. For security:
 |  
 |      - Load models only from trusted sources
 |      - Consider using safer formats like ONNX or TorchScript for production use
 |  
 |      To proceed with loading, set:
 |  
 |      .. code-block:: bash
 |  
 |          export TRUST_REMOTE_CODE=1
 |  
 |  Args:
 |      path (str | Path): Path to the PyTorch model weights file.
 |      device (str, optional): Device to use for inference.
 |          Options are ``"auto"``, ``"cpu"``, ``"cuda"``, ``"gpu"``.
 |          Defaults to ``"auto"``.
 |  
 |  Example:
 |      >>> from anomalib.deploy import TorchInferencer
 |      >>> model = TorchInferencer(path="path/to/model.pt")
 |      >>> predictions = model.predict(image="path/to/image.jpg")
 |  
 |  Raises:
 |      ValueError: If an invalid device is specified.
 |      ValueError: If the model file has an unknown extension.
 |      ValueError: If TRUST_REMOTE_CODE environment variable is not set.
 |      KeyError: If the checkpoint file does not contain a model.
 |  
 |  Methods defined here:
 |  
 |  __init__(self, path: str | pathlib.Path, device: str = 'auto') -> None
 |      Initialize self.  See help(type(self)) for accurate signature.
 |  
 |  load_model(self, path: str | pathlib.Path) -> torch.nn.modules.module.Module
 |      Load the PyTorch model.
 |      
 |      Args:
 |          path (str | Path): Path to the PyTorch model file.
 |      
 |      Returns:
 |          nn.Module: Loaded PyTorch model in evaluation mode.
 |      
 |      Raises:
 |          KeyError: If the checkpoint file does not contain a model.
 |      
 |      Example:
 |          >>> model = TorchInferencer(path="path/to/model.pt")
 |          >>> isinstance(model.model, nn.Module)
 |          True
 |  
 |  pre_process(self, image: torch.Tensor) -> torch.Tensor
 |      Pre-process the input image.
 |      
 |      Args:
 |          image (torch.Tensor): Input image tensor.
 |      
 |      Returns:
 |          torch.Tensor: Pre-processed image tensor.
 |      
 |      Example:
 |          >>> model = TorchInferencer(path="path/to/model.pt")
 |          >>> image = torch.rand(3, 224, 224)
 |          >>> processed = model.pre_process(image)
 |          >>> processed.shape
 |          torch.Size([1, 3, 224, 224])
 |  
 |  predict(self, image: str | pathlib.Path | numpy.ndarray | PIL.Image.Image | torch.Tensor) -> anomalib.data.dataclasses.torch.image.ImageBatch
 |      Predict anomalies for an input image.
 |      
 |      Args:
 |          image (str | Path | np.ndarray | PILImage | torch.Tensor): Input image to predict.
 |              Can be a file path or PyTorch tensor.
 |      
 |      Returns:
 |          ImageBatch: Prediction results containing anomaly maps and scores.
 |      
 |      Example:
 |          >>> model = TorchInferencer(path="path/to/model.pt")
 |          >>> predictions = model.predict("path/to/image.jpg")
 |          >>> predictions.anomaly_map.shape  # doctest: +SKIP
 |          torch.Size([1, 256, 256])
 |  
 |  ----------------------------------------------------------------------
 |  Data descriptors defined here:
 |  
 |  __dict__
 |      dictionary for instance variables
 |  
 |  __weakref__
 |      list of weak references to the object

