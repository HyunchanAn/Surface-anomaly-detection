# Surface Anomaly Detection Configuration (PatchCore)

dataset:
  name: surface_dataset
  format: folder
  path: ./datasets/custom
  normal_dir: normal    # Path to normal images relative to 'path'
  abnormal_dir: abnormal # Path to abnormal images relative to 'path'
  task: classification # or segmentation if we have masks, but classification is easier for start
  mask_dir: null       # Set this if you have ground truth masks later
  extensions: null     # Auto-detect (.jpg, .png, etc.)
  split_mode: from_dir # Expects test/train split or auto-split? 
                       # For simple demo: 'none' or 'from_dir'. 
                       # Anomalib 'folder' dataset usually expects 'train/good', 'test/good', 'test/bad'.
                       # However, to keep it simple for the user (just 'normal' folder), we might need to adjust or let script handle split.
                       # Let's target the standard anomalib folder structure:
                       # datasets/custom/train/good
                       # datasets/custom/test/good
                       # datasets/custom/test/bad
                       # But user wants simple 50 images. 
                       # We will configure for a simple structure and rely on the train script to handle data splitting if possible 
                       # OR simply ask user to arrange files.
                       # EASIEST: train_batch_size matches data.
  image_size: 224 # PatchCore default
  center_crop: null # No cropping for surface inspection usually
  normalization: imagenet # Standard
  train_batch_size: 8 # Good for 4060 Laptop (8GB VRAM)
  eval_batch_size: 8
  num_workers: 4
  
model:
  name: patchcore
  backbone: wide_resnet50_2 # Good balance of speed/accuracy
  pre_trained: true
  coreset_sampling_ratio: 0.1 # Dataset sampling ratio
  num_neighbors: 9

metrics:
  image:
    - F1Score
    - AUROC
  pixel:
    - F1Score
    - AUROC
  threshold:
    method: adaptive # Auto-calculate threshold

trainer:
  accelerator: auto # Auto-detect GPU/CPU
  devices: 1
  max_epochs: 1 # PatchCore essentially fits in 1 epoch (it's memory bank based)
  default_root_dir: ./results
  val_check_interval: 1.0 # Check val every epoch

logging:
  logger: [] # Disable heavy logging for demo
  log_graph: false

project:
  seed: 42
  path: ./results
